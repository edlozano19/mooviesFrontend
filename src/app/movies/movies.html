<div class="movies-container">
    <div class="search-section">
        <h1>Search Movies</h1>
        <div class="search-bar">
            <input
                type="text"
                [(ngModel)]="searchQuery"
                (keyup.enter)="onSearch()"
                placeholder="Search for movies..."
                class="search-input"
            >
            <button (click)="onSearch()" class="search-button">Search</button>
        </div>

        @if (totalResults() > 0) {
            <p class="results-info">
                Found {{ totalResults() }} results for "{{ searchQuery() }}"
            </p>
        }
    </div>

    @if (isLoading()) {
        <div class="loading">
            <p>Searching for movies...</p>
        </div>
    }
    @else if (error()) {
        <div class="error">
            <p>{{ error() }}</p>
        </div>
    }
    @else if (movies().length > 0) {
        <div class="movies-grid">
            @for (movie of movies(); track movie.id) {
                <a [routerLink]="['/movie', movie.id]" class="movie-card">
                    <div class="movie-poster">
                        <img [src]="getPosterUrl(movie.poster_path)" [alt]="movie.title" />
                    </div>
                    <div class="movie-info">
                        <h3>{{ movie.title }}</h3>
                        <p class="release-year">{{ formatDate(movie.release_date) }}</p>
                        @if (movie.overview) {
                            <p class="movie-overview">{{ movie.overview }}</p>
                        }
                    </div>
                </a>
            }
        </div>

        @if (totalPages() > 1) {
            <div class="pagination">
                <button
                    (click)="previousPage()"
                    [disabled]="currentPage() <= 1"
                    class="page-btn"
                >
                    ← Previous
                </button>
                
                <div class="page-numbers">
                    @for (page of getPageNumbers(); track page; let i = $index) {
                        @if (shouldShowEllipsis(i)) {
                            <span class="ellipsis">...</span>
                        }
                        <button
                            (click)="goToPage(page)"
                            [class.active]="page === currentPage()"
                            class="page-btn"
                        >
                            {{ page }}
                        </button>
                    }
                </div>

                <button
                    (click)="nextPage()"
                    [disabled]="currentPage() >= totalPages()"
                    class="page-btn"
                >
                    Next →
                </button>
            </div>
        }
    }
    @else if (searchQuery()) {
        <div class="no-results">
            <p>No movies found for "{{ searchQuery() }}"</p>
            <p>Try searching for something else</p>
        </div>
    }
    @else {
        <div class="search-prompt">
            <p>Enter a movie title to search</p>
        </div>
    }
</div>